/* 3) Add these helpers and use them for BOTH commit and recall */

function normalizeSignature(raw){
  // Normalize for consistent exact matching:
  // - trim ends
  // - collapse repeated whitespace
  // - lowercase
  // If you truly want case-sensitive, remove .toLowerCase()
  return String(raw || "")
    .trim()
    .replace(/\s+/g, " ")
    .toLowerCase();
}

// IMPORTANT: remove any code that was "masking" or replacing characters as you type.
// For example, if you have an input listener that changes el("cloudSignature").value,
// delete it entirely. You do NOT need any oninput handler for Signature.

// Example usage inside your cloud functions:
async function cloudCommit(){
  const sigRaw = el("cloudSignature").value;
  const sig = normalizeSignature(sigRaw);
  if (!sig){
    toast("Write a Signature.", "bad");
    return;
  }

  // Use `sig` as your slot key, both write and read must use the same normalized string.
  // Example:
  // const slotId = sig;  // or hash(sig) if you implemented hashing
  // ...perform upsert with slotId...
}

async function cloudRecall(){
  const sigRaw = el("cloudSignature").value;
  const sig = normalizeSignature(sigRaw);
  if (!sig){
    toast("Write a Signature.", "bad");
    return;
  }

  // Same derivation as commit:
  // const slotId = sig;
  // ...perform select by slotId...
}
